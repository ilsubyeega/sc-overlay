import{H as e,I as n}from"./client.7123c125.js";function t(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var o=e((function(e){var t,o;t=n,o=function(){if("undefined"!=typeof window&&"WebSocket"in window)return e.prototype.onopen=function(e){},e.prototype.onclose=function(e){},e.prototype.onconnecting=function(e){},e.prototype.onmessage=function(e){},e.prototype.onerror=function(e){},e.debugAll=!1,e.CONNECTING=WebSocket.CONNECTING,e.OPEN=WebSocket.OPEN,e.CLOSING=WebSocket.CLOSING,e.CLOSED=WebSocket.CLOSED,e;function e(n,t,o){var c={debug:!1,automaticOpen:!0,reconnectInterval:1e3,maxReconnectInterval:3e4,reconnectDecay:1.5,timeoutInterval:2e3,maxReconnectAttempts:null,binaryType:"blob"};for(var i in o||(o={}),c)void 0!==o[i]?this[i]=o[i]:this[i]=c[i];this.url=n,this.reconnectAttempts=0,this.readyState=WebSocket.CONNECTING,this.protocol=null;var r,s=this,a=!1,u=!1,l=document.createElement("div");function d(e,n){var t=document.createEvent("CustomEvent");return t.initCustomEvent(e,!1,!1,n),t}l.addEventListener("open",(function(e){s.onopen(e)})),l.addEventListener("close",(function(e){s.onclose(e)})),l.addEventListener("connecting",(function(e){s.onconnecting(e)})),l.addEventListener("message",(function(e){s.onmessage(e)})),l.addEventListener("error",(function(e){s.onerror(e)})),this.addEventListener=l.addEventListener.bind(l),this.removeEventListener=l.removeEventListener.bind(l),this.dispatchEvent=l.dispatchEvent.bind(l),this.open=function(n){if((r=new WebSocket(s.url,t||[])).binaryType=this.binaryType,n){if(this.maxReconnectAttempts&&this.reconnectAttempts>this.maxReconnectAttempts)return}else l.dispatchEvent(d("connecting")),this.reconnectAttempts=0;(s.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","attempt-connect",s.url);var o=r,c=setTimeout((function(){(s.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","connection-timeout",s.url),u=!0,o.close(),u=!1}),s.timeoutInterval);r.onopen=function(t){clearTimeout(c),(s.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","onopen",s.url),s.protocol=r.protocol,s.readyState=WebSocket.OPEN,s.reconnectAttempts=0;var o=d("open");o.isReconnect=n,n=!1,l.dispatchEvent(o)},r.onclose=function(t){if(clearTimeout(c),r=null,a)s.readyState=WebSocket.CLOSED,l.dispatchEvent(d("close"));else{s.readyState=WebSocket.CONNECTING;var o=d("connecting");o.code=t.code,o.reason=t.reason,o.wasClean=t.wasClean,l.dispatchEvent(o),n||u||((s.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","onclose",s.url),l.dispatchEvent(d("close")));var c=s.reconnectInterval*Math.pow(s.reconnectDecay,s.reconnectAttempts);setTimeout((function(){s.reconnectAttempts++,s.open(!0)}),c>s.maxReconnectInterval?s.maxReconnectInterval:c)}},r.onmessage=function(n){(s.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","onmessage",s.url,n.data);var t=d("message");t.data=n.data,l.dispatchEvent(t)},r.onerror=function(n){(s.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","onerror",s.url,n),l.dispatchEvent(d("error"))}},1==this.automaticOpen&&this.open(!1),this.send=function(n){if(r)return(s.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","send",s.url,n),r.send(n);throw"INVALID_STATE_ERR : Pausing to reconnect websocket"},this.close=function(e,n){void 0===e&&(e=1e3),a=!0,r&&r.close(e,n)},this.refresh=function(){r&&r.close()}}},e.exports?e.exports=o():t.ReconnectingWebSocket=o()}));export{t as _,o as r};
